diff -u icecast2-2.3.2/debian/changelog icecast2-2.3.2/debian/changelog
--- icecast2-2.3.2/debian/changelog
+++ icecast2-2.3.2/debian/changelog
@@ -1,3 +1,12 @@
+icecast2 (2.3.2-5ubuntu2) lucid-security; urgency=low
+
+  * SECURITY UPDATE: Newline injection in error.log (LP: 894782)
+    - src/fserve.c: modify fserve_client_create to check for '\r', '\n'
+      and trim the string with its occurance, if any.
+    - CVE-2011-4612
+
+ -- Zubin Mithra <zubin.mithra@gmail.com>  Mon, 20 Feb 2012 19:11:18 +0530
+
 icecast2 (2.3.2-5ubuntu1) lucid; urgency=low
 
   * 1004_fix_xmlCleanupParser_splatter.patch: Make sure that
only in patch2:
unchanged:
--- icecast2-2.3.2.orig/src/fserve.c
+++ icecast2-2.3.2/src/fserve.c
@@ -395,9 +395,23 @@
     int xspf_requested = 0, xspf_file_available = 1;
     ice_config_t *config;
     FILE *file;
+    int i;
+    char *filtered_path;
 
-    fullpath = util_get_path_from_normalised_uri (path);
-    INFO2 ("checking for file %s (%s)", path, fullpath);
+    /* Remove occurances of '\r' and '\n', if any */
+    filtered_path = (char *)malloc(strlen(path));
+    for(i=0; path[i]!='\0'; ++i) {
+        if(path[i] == '\r' || path[i] == '\n') {
+            filtered_path[i] = '\0';
+            break;
+        }
+        else
+            filtered_path[i] = path[i];
+    }
+
+    fullpath = util_get_path_from_normalised_uri (filtered_path);
+    INFO2 ("checking for file %s (%s)", filtered_path, fullpath);
+    free(filtered_path);
 
     if (strcmp (util_get_extension (fullpath), "m3u") == 0)
         m3u_requested = 1;
